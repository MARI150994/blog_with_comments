# API для системы комментариев блога

### В проекте используется:
* Django
* DRF
* django-mptt
* PostgreSQL
* Docker
* Docker-compose

### **Запуск приложения**
* Для запуска Вам понадобится git, docker, docker-compose
* склонируйте данный репозиторий с помощью команды: _git clone git@github.com:MARI150994/blog_with_comments.git_
* перейдите в паку block_comments: cd block_comments
* соберите и запустите докер образ: _docker-compose up -d --build app_
* используйте перечисленные ниже endpoints для тестирования ресурсов API,
приложение по умолчанию запускается на 0.0.0.0:8000, перейдите в браузере по ссылке _http://0.0.0.0:8000/api/<ресурс>_ либо используйте Postman и тп

### Endpoints

| url                                     | method | params                                             | description                                                                                                                                                                       |
|-----------------------------------------|--------|----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /api/articles/                          | GET    |                                                    | Список статей. Возвращает статус 200 с телом: title, url(for article), created(data) для каждой статьи                                                                            |
| /api/articles/                          | POST   | body: "title": "str", "content": "str"             | Создание статьи. Возвращает статус 201 с телом: title, url(for article), created(data) если успешно, иначе - 400                                                                  |
| /api/articles/<article_id:int>/         | GET    | path: "article_id": int                            | Детальная информация о статье. Возвращает статус 200 с телом: title, content, created(data), comments(c иерархией комментариев см. примечание), если нет статьи с таким id то 404 |
| /api/article/<article_id:int>/comments/ | POST   | path: "article_id": int<br/>body: "content": "str" | Создание комментария к статье. Возвращает статус 201 с телом: content, created(data) если успешно, иначе 400, если нет статьи с таким id то 404                                   |
| /api/comments/<comment_id:int>/         | GET    | path: "comment_id": int                            | Список подкомментариев к комментарию. <br/> Возвращает статус 200 с телом, где детальная информация о каждом комментарии в виде иерархии, если нет комментария с таким id то 404  |
| /api/comments/<comment_id:int>/         | POST   | path: "comment_id": int<br/>body: "content": "str" | Создание комментария к любому комментарию. Возвращает статус 201 с телом: content, created(data) если успешно, иначе 400, если нет комментария с таким id то 404                  |

Примечание. Иерархия комментариев на странице статьи выглядит как показано ниже. В поле _**children**_ иерархия подкомментариев. 
Если отображаем комментарии на странице статьи то для комментария с третьим уровнем вложенности в поле children будет ссылка вида /api/comments/<comment_id:int>/ 
на детальную информацию о всех подкомментариев любого уровня вложенности для данного комментария. Если подкомментариев нет, то список пуст.
 *     
        {
            "id": 1,
            "parent_id": null,
            "url": "http://0.0.0.0:8000/api/comments/1",
            "content": "commm1",
            "created": "2022-04-26T16:00:28.305288Z",
            "level": 0,
            "children": [
                {
                    "id": 3,
                    "parent_id": 1,
                    "url": "http://0.0.0.0:8000/api/comments/3",
                    "content": "reply1",
                    "created": "2022-04-26T16:00:50.662303Z",
                    "level": 1,
                    "children": [
                        {
                            "id": 4,
                            "parent_id": 3,
                            "url": "http://0.0.0.0:8000/api/comments/4",
                            "content": "subcom",
                            "created": "2022-04-26T16:01:26.854445Z",
                            "level": 2,
                            "children": "http://0.0.0.0:8000/api/comments/4"
                        }
                    ]
                }
            ]
        },


